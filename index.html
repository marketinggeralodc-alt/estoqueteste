<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Pedidos OdontoCompany (Online)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide-icons"></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        .page { display: none; }
        .status-pendente { background-color: #fef9c3; border-left-color: #facc15; }
        .status-aprovado { background-color: #dcfce7; border-left-color: #22c55e; }
        .status-rejeitado { background-color: #fee2e2; border-left-color: #ef4444; }
        
        @media print {
            body > * { display: none !important; }
            #print-area, #print-area * { display: block !important; visibility: visible !important; }
            #print-area { position: absolute; left: 0; top: 0; width: 100%; color: #000; }
            .print-header { font-size: 24px; font-weight: bold; margin-bottom: 20px; text-align: center; }
            .print-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            .print-table th, .print-table td { border: 1px solid #ccc; padding: 8px; text-align: left; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <div id="app" class="w-full">
        <div id="page-select-filial" class="page flex flex-col items-center justify-center min-h-screen p-4">
            <div class="w-full max-w-md bg-white rounded-lg shadow-xl p-8">
                <div class="flex justify-center mb-6">
                    <svg class="h-16 w-16 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-1 4h1m4-8h1m-1 4h1m-1 4h1" />
                    </svg>
                </div>
                <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Controle de Pedidos</h1>
                <p class="text-center text-sm text-green-600 mb-4 font-bold flex items-center justify-center gap-2">
                    <i data-lucide="cloud" class="w-4 h-4"></i> Sistema Online (Firebase)
                </p>
                <div class="space-y-4">
                    <button onclick="goToLogin('Patos de Minas')" class="w-full text-lg text-white bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-lg font-semibold shadow-md">Patos de Minas</button>
                    <button onclick="goToLogin('São Gotardo')" class="w-full text-lg text-white bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-lg font-semibold shadow-md">São Gotardo</button>
                    <button onclick="goToLogin('Ibiá')" class="w-full text-lg text-white bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-lg font-semibold shadow-md">Ibiá</button>
                    <button onclick="goToLogin('Guarda dos Ferreiros')" class="w-full text-lg text-white bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-lg font-semibold shadow-md">Guarda dos Ferreiros</button>
                </div>
                <div class="text-center mt-6">
                    <a href="#" onclick="goToAdminLogin()" class="text-sm text-gray-500 hover:text-blue-600">Login de Administrador</a>
                </div>
            </div>
        </div>

        <div id="page-login" class="page flex flex-col items-center justify-center min-h-screen p-4">
            <div class="w-full max-w-sm bg-white rounded-lg shadow-xl p-8">
                <button onclick="goToPage('page-select-filial')" class="text-gray-500 hover:text-blue-600 mb-4">&larr; Voltar</button>
                <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">Login: <span id="login-filial-name" class="text-blue-600"></span></h2>
                <input type="password" id="filial-password" placeholder="Digite sua senha" class="w-full border border-gray-300 rounded-lg p-3 text-center text-lg mb-4">
                <button onclick="handleFilialLogin()" class="w-full text-lg text-white bg-green-600 hover:bg-green-700 py-3 px-4 rounded-lg font-semibold shadow-md">Entrar</button>
            </div>
        </div>
        
        <div id="page-admin-login" class="page flex flex-col items-center justify-center min-h-screen p-4">
            <div class="w-full max-w-sm bg-white rounded-lg shadow-xl p-8">
                <button onclick="goToPage('page-select-filial')" class="text-gray-500 hover:text-blue-600 mb-4">&larr; Voltar</button>
                <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">Login de <span class="text-red-600">Admin</span></h2>
                <input type="password" id="admin-password" placeholder="Senha mestre" class="w-full border border-gray-300 rounded-lg p-3 text-center text-lg mb-4">
                <button onclick="handleAdminLogin()" class="w-full text-lg text-white bg-red-600 hover:bg-red-700 py-3 px-4 rounded-lg font-semibold shadow-md">Entrar</button>
            </div>
        </div>

        <div id="page-menu" class="page container mx-auto p-4 md:p-8 max-w-4xl">
            <header class="flex justify-between items-center mb-8">
                <h1 class="text-3xl font-bold text-blue-600">Filial: <span id="menu-filial-name"></span></h1>
                <button onclick="logout()" class="text-gray-600 hover:text-red-600 font-semibold py-2 px-4 rounded-lg border">Sair</button>
            </header>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-xl p-6 flex flex-col items-center text-center">
                    <i data-lucide="edit" class="h-16 w-16 text-blue-600 mb-4"></i>
                    <h2 class="text-2xl font-semibold mb-2">Gerenciar Estoque</h2>
                    <p class="text-gray-600 mb-4">Atualize seu estoque atual.</p>
                    <button onclick="goToPage('page-manage-stock')" class="w-full text-lg text-white bg-blue-600 hover:bg-blue-700 py-3 px-4 rounded-lg font-semibold shadow-md">Acessar</button>
                </div>
                <div class="bg-white rounded-lg shadow-xl p-6 flex flex-col items-center text-center">
                    <i data-lucide="shopping-cart" class="h-16 w-16 text-green-600 mb-4"></i>
                    <h2 class="text-2xl font-semibold mb-2">Fazer Pedido</h2>
                    <p class="text-gray-600 mb-4">Gere pedidos baseados no mínimo.</p>
                    <button onclick="goToPage('page-order-form')" class="w-full text-lg text-white bg-green-600 hover:bg-green-700 py-3 px-4 rounded-lg font-semibold shadow-md">Acessar</button>
                </div>
            </div>
        </div>

        <div id="page-manage-stock" class="page container mx-auto p-4 md:p-8 max-w-6xl">
            <button onclick="goToPage('page-menu')" class="mb-6 text-gray-600 hover:text-blue-600 font-semibold">&larr; Voltar</button>
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Estoque (<span id="stock-filial-name" class="text-blue-600"></span>)</h1>
            
            <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4">
                <input type="text" id="stock-search" onkeyup="filterTable('stock-search', 'stock-table-body')" placeholder="Buscar produto..." class="w-full p-2 border rounded shadow">
                <button onclick="openAddProductModal()" class="w-full md:w-auto text-lg text-white bg-green-600 hover:bg-green-700 py-2 px-5 rounded-lg font-semibold shadow-md">
                    + Novo Produto
                </button>
            </div>

            <div class="overflow-x-auto bg-white rounded-lg shadow-xl">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-6 py-3 text-left font-bold text-gray-600 uppercase">Produto</th>
                            <th class="px-6 py-3 text-center font-bold text-gray-600 uppercase">Mínimo</th>
                            <th class="px-6 py-3 text-center font-bold text-gray-600 uppercase">Atual</th>
                            <th class="px-6 py-3 text-center font-bold text-gray-600 uppercase">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="stock-table-body" class="bg-white divide-y divide-gray-200"></tbody>
                </table>
            </div>
            <button onclick="saveStock()" class="mt-8 w-full text-xl text-white bg-blue-600 hover:bg-blue-700 py-4 px-6 rounded-lg font-semibold shadow-lg">Salvar Alterações na Nuvem</button>
        </div>

        <div id="page-order-form" class="page container mx-auto p-4 md:p-8 max-w-6xl">
            <button onclick="goToPage('page-menu')" class="mb-6 text-gray-600 hover:text-blue-600 font-semibold">&larr; Voltar</button>
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Novo Pedido</h1>
            
            <input type="text" id="order-search" onkeyup="filterTable('order-search', 'order-table-body')" placeholder="Filtrar..." class="w-full p-2 border rounded shadow mb-4">

            <div class="overflow-x-auto bg-white rounded-lg shadow-xl">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-6 py-3 text-left font-bold text-gray-600 uppercase">Produto</th>
                            <th class="px-6 py-3 text-center font-bold text-gray-600 uppercase">Mín</th>
                            <th class="px-6 py-3 text-center font-bold text-gray-600 uppercase">Estoque</th>
                            <th class="px-6 py-3 text-center font-bold text-red-600 uppercase">Sugestão</th>
                            <th class="px-6 py-3 text-center font-bold text-green-600 uppercase">Pedir</th>
                        </tr>
                    </thead>
                    <tbody id="order-table-body" class="bg-white divide-y divide-gray-200"></tbody>
                </table>
            </div>

            <div class="bg-white rounded-lg shadow-xl p-6 mt-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Extras / Observações</h2>
                <textarea id="extra-items-textarea" rows="4" class="w-full border border-gray-300 rounded-lg p-3" placeholder="Ex: 5 caixas de Luvas P..."></textarea>
            </div>

            <button onclick="reviewOrder()" class="mt-8 w-full text-xl text-white bg-blue-600 hover:bg-blue-700 py-4 px-6 rounded-lg font-semibold shadow-lg">Revisar Pedido</button>
        </div>

        <div id="page-review-order" class="page container mx-auto p-4 md:p-8 max-w-4xl">
            <button onclick="goToPage('page-order-form')" class="mb-6 text-gray-600 hover:text-blue-600 font-semibold">&larr; Editar</button>
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Revisar Pedido</h1>
            <div id="review-summary-container" class="bg-white rounded-lg shadow-xl p-6"></div>
            
            <div class="mt-8 flex flex-col sm:flex-row gap-4">
                <button onclick="printOrder(currentOrder, currentExtraItems)" class="flex-1 text-lg text-blue-600 bg-white border border-blue-600 py-3 rounded-lg font-semibold">Imprimir</button>
                <button onclick="submitOrder()" class="flex-1 text-lg text-white bg-green-600 hover:bg-green-700 py-3 rounded-lg font-semibold shadow-md">Confirmar Envio</button>
            </div>
        </div>
        
        <div id="page-admin-panel" class="page container mx-auto p-4 md:p-8 max-w-6xl">
            <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-red-600">Painel Admin (Online)</h1>
                    <p class="text-gray-500">Gerenciamento de Pedidos em Tempo Real</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="refreshAdminPanel()" class="text-blue-600 border border-blue-200 bg-blue-50 hover:bg-blue-100 font-semibold px-4 py-2 rounded flex items-center gap-2">
                         <i data-lucide="refresh-cw" class="w-4 h-4"></i> Atualizar
                    </button>
                    <button onclick="logout()" class="text-gray-600 hover:text-red-600 font-semibold border px-4 py-2 rounded">Sair</button>
                </div>
            </header>
            
            <div id="admin-list-container" class="space-y-6">
                </div>
            <p id="no-pending-orders" class="text-center text-gray-500 py-10 hidden">Nenhum pedido pendente.</p>
        </div>

    </div>

    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" style="display: none; z-index: 9999;">
        <div class="bg-white p-5 rounded-lg flex flex-col items-center">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-3"></div>
            <div class="text-gray-800 font-bold">Processando...</div>
        </div>
    </div>
    <div id="alert-box" class="fixed top-5 right-5 bg-gray-800 text-white p-4 rounded-lg shadow-xl hidden" style="display: none; z-index: 10000;">
        <span id="alert-message"></span>
    </div>
    <div id="print-area" class="hidden"></div>
    
    <div id="modal-add-product" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden" style="display: none; z-index: 9990;">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg p-6">
            <h2 class="text-2xl font-bold mb-4">Novo Produto</h2>
            <div class="space-y-4">
                <input type="text" id="new-prod-desc" placeholder="Descrição" class="w-full border p-2 rounded">
                <input type="text" id="new-prod-cat" placeholder="Categoria" class="w-full border p-2 rounded">
                <input type="text" id="new-prod-marca" placeholder="Marca" class="w-full border p-2 rounded">
            </div>
            <div class="flex justify-end gap-4 mt-6">
                <button onclick="closeAddProductModal()" class="text-gray-600">Cancelar</button>
                <button onclick="addNewProduct()" class="bg-green-600 text-white px-4 py-2 rounded">Adicionar</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Importando do Firebase (Versão 12.6.0 conforme solicitado)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, collection, doc, getDoc, setDoc, addDoc, getDocs, updateDoc, query, where, orderBy } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

        // --- CONFIGURAÇÃO DO FIREBASE (SUAS CHAVES) ---
        const firebaseConfig = {
            apiKey: "AIzaSyACXxrJYZmIgBK65t-aAL8wa7wNsQxRuCE",
            authDomain: "odonto-teste-71e4c.firebaseapp.com",
            projectId: "odonto-teste-71e4c",
            storageBucket: "odonto-teste-71e4c.firebasestorage.app",
            messagingSenderId: "198684123468",
            appId: "1:198684123468:web:849033310014d7e5146fe9"
        };

        // Inicializa Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- VARIÁVEIS GLOBAIS ---
        window.selectedFilial = null;
        let filialInventory = {};
        window.currentOrder = {};
        window.currentExtraItems = "";
        
        const FILIAL_PASSWORDS = { 'Patos de Minas': '123', 'São Gotardo': '123', 'Ibiá': '123', 'Guarda dos Ferreiros': '123' };
        const ADMIN_PASSWORD = 'admin123';

        // CATÁLOGO COMPLETO
        const INITIAL_CATALOG = {
            "AGULHA CURTA": { cat: "CIRURGIA", marca: "ALLPRIME", min: 2 },
            "AGULHA LONGA": { cat: "CIRURGIA", marca: "ALLPRIME", min: 1 },
            "ALPHACAINA": { cat: "CIRURGIA", marca: "DFL", min: 4 },
            "ANESTÉSICO ARTICAINE": { cat: "CIRURGIA", marca: "DFL", min: 3 },
            "BENSONTOP": { cat: "CIRURGIA", marca: "DFL", min: 3 },
            "FIO DE SUTURA 3-0 NLON": { cat: "CIRURGIA", marca: "PROCARE", min: 4 },
            "FIO DE SUTURA 4-0 NYLON": { cat: "CIRURGIA", marca: "PROCARE", min: 2 },
            "HEMOLIQ": { cat: "CIRURGIA", marca: "MAQUIRA", min: 2 },
            "HEMOSPON - ESPONJA HEMOSTÁTICA": { cat: "CIRURGIA", marca: "MAQUIRA", min: 4 },
            "LÂMINA DE BISTURI Nº12": { cat: "CIRURGIA", marca: "SOLIDOR", min: 2 },
            "LÂMINA DE BISTURI Nº15": { cat: "CIRURGIA", marca: "SOLIDOR", min: 3 },
            "LUVA CIRURGICA 7,5": { cat: "CIRURGIA", marca: "DESCARPAK", min: 20 },
            "LUVA CIRURGICA ESTÉRIL 6,5": { cat: "CIRURGIA", marca: "DESCARPAK", min: 30 },
            "MEPVACAINE S/ VASO CONSTRICTOR": { cat: "CIRURGIA", marca: "DFL", min: 1 },
            "PLACA MOLDEIRA 1MM": { cat: "CIRURGIA", marca: "VILLEVIE", min: 4 },
            "SUGADOR CIRURGICO (CAIXA)": { cat: "CIRURGIA", marca: "MAQUIRA", min: 3 },
            "PASTA DE POLIMENTO DIAMOND": { cat: "DENTÍSTICA", marca: "FGM", min: 1 },
            "Resina FORMA A 2d": { cat: "DENTÍSTICA", marca: "ULTRADENT", min: 1 },
            "Resina Z250 - 3,5": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "Resina Z250 - B1": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "SISTEMA ADESIVO AUTOCOND. TAMPA VERMELHA": { cat: "DENTÍSTICA", marca: "AMBAR", min: 1 },
            "Acido Fluorídrico": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 6 },
            "Acido Fosfórico": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 20 },
            "Acrílica AltoPolimerizante 61": { cat: "DENTÍSTICA", marca: "DENCOR", min: 1 },
            "Acrílica AltoPolimerizante 62": { cat: "DENTÍSTICA", marca: "DENCOR", min: 1 },
            "Acrílica AltoPolimerizante 66": { cat: "DENTÍSTICA", marca: "DENCOR", min: 1 },
            "Acrílica AltoPolimerizante 69": { cat: "DENTÍSTICA", marca: "DENCOR", min: 1 },
            "Adesivo bond 2.1": { cat: "DENTÍSTICA", marca: "BIODINAMIC", min: 4 },
            "Adesivo MONO ADAPER SINGLE BOND 3 M": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Banda Metálica 0,5": { cat: "DENTÍSTICA", marca: "PREVEN", min: 5 },
            "Banda Metálica 0,7": { cat: "DENTÍSTICA", marca: "PREVEN", min: 4 },
            "Bicarbonato": { cat: "DENTÍSTICA", marca: "MAQUIRA", min: 1 },
            "BROCA ZECRYA": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 6 },
            "Carbono para ajuste de oclusão": { cat: "DENTÍSTICA", marca: "MAQUIRA", min: 8 },
            "Cartão de Raio X": { cat: "DENTÍSTICA", marca: "PREVEN", min: 1 },
            "Cera 7": { cat: "DENTÍSTICA", marca: "LYSANDA", min: 2 },
            "Cera Utilidade Vermelha": { cat: "DENTÍSTICA", marca: "LYSANDA", min: 2 },
            "Cimento Resinoso DUAL": { cat: "DENTÍSTICA", marca: "VIGODENT", min: 3 },
            "CLAREAMENTO CASEIRO 16%": { cat: "DENTÍSTICA", marca: "FGM", min: 1 },
            "CLAREAMENTO CASEIRO 22%": { cat: "DENTÍSTICA", marca: "FGM", min: 4 },
            "Clareamento Consultório - HP": { cat: "DENTÍSTICA", marca: "FGM", min: 2 },
            "Cunha de madeira": { cat: "DENTÍSTICA", marca: "TDV", min: 2 },
            "RESINA AUTO ROSA": { cat: "DENTÍSTICA", marca: "DENCRILAY", min: 2 },
            "DISCO DE LIXA soft-lex pop-on": { cat: "DENTÍSTICA", marca: "3M", min: 1 },
            "Escova de Robson": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 30 },
            "Filme Adulto": { cat: "DENTÍSTICA", marca: "CARESTEA", min: 1 },
            "Filme Infantil": { cat: "DENTÍSTICA", marca: "CARESTEA", min: 1 },
            "Fio dental": { cat: "DENTÍSTICA", marca: "HILLO", min: 2 },
            "Flúor": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 2 },
            "Gel dessensibilizante": { cat: "DENTÍSTICA", marca: "FGM", min: 1 },
            "Hydcal- hidroxido de calcio": { cat: "DENTÍSTICA", marca: "MAQUIRA", min: 2 },
            "Ionomero de vidro po/liquido": { cat: "DENTÍSTICA", marca: "FGM", min: 2 },
            "Lixa Abrasiva de Metal": { cat: "DENTÍSTICA", marca: "INJECTA", min: 6 },
            "Tiras de lixa de poliester abrasiva": { cat: "DENTÍSTICA", marca: "Allprime", min: 4 },
            "Micro Brush regular": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 6 },
            "Obturador Provisório": { cat: "DENTÍSTICA", marca: "VILLEVIE", min: 4 },
            "Pasta de Zinco": { cat: "DENTÍSTICA", marca: "LYSANDA", min: 1 },
            "Pasta Profilática": { cat: "DENTÍSTICA", marca: "ALL PRIME", min: 4 },
            "PEDRA ASKANS": { cat: "DENTÍSTICA", marca: "AMERICAN BURS", min: 5 },
            "Pedra Pomes": { cat: "DENTÍSTICA", marca: "SSWHITE", min: 1 },
            "Pino de Fibra de Vidro 0.5": { cat: "DENTÍSTICA", marca: "SUPERPOST", min: 3 },
            "Resina Acrílica incolor": { cat: "DENTÍSTICA", marca: "DENCOR", min: 1 },
            "Resina Auto": { cat: "DENTÍSTICA", marca: "CLASSICO", min: 1 },
            "Resina Master Flow A3,5": { cat: "DENTÍSTICA", marca: "BIODINAMIC", min: 3 },
            "RESINA MASTER FLOW A1": { cat: "DENTÍSTICA", marca: "BIODINAMIC", min: 2 },
            "RESINA FORMA A3E": { cat: "DENTÍSTICA", marca: "ULTRADENT", min: 1 },
            "RESINA FORMA A1E": { cat: "DENTÍSTICA", marca: "ULTRADENT", min: 1 },
            "RESINA FORMA A2E": { cat: "DENTÍSTICA", marca: "ULTRADENT", min: 1 },
            "Resina Master Flow A2": { cat: "DENTÍSTICA", marca: "BIODINAMIC", min: 3 },
            "Resina Master Flow A3": { cat: "DENTÍSTICA", marca: "BIODINAMIC", min: 3 },
            "Resina Z 250- OA2": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "Resina Z100 - A1": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z100 - A2": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z100 - A3": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z100 - A3.5": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z100 - A4": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z100 - B2": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z250 - A1": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z250 - A2": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "Resina Z250 - OA1": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "RESINA Z250 A3": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "Selante Yseal": { cat: "DENTÍSTICA", marca: "YLLER", min: 1 },
            "RESINA Z250 A 3,5": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 2 },
            "RESINA Z250 B1": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "RESINA Z250 OA2": { cat: "DENTÍSTICA", marca: "SOLVENTUM", min: 1 },
            "Silano": { cat: "DENTÍSTICA", marca: "VILLEVIE", min: 3 },
            "Silicone Optozil (ACTIVADOR)": { cat: "DENTÍSTICA", marca: "KULZER", min: 5 },
            "Silicone Optozil (DENSO)": { cat: "DENTÍSTICA", marca: "KULZER", min: 4 },
            "Silicone Optozil (LEVE)": { cat: "DENTÍSTICA", marca: "KULZER", min: 6 },
            "Tira de Poliéster transparente": { cat: "DENTÍSTICA", marca: "Kdent", min: 4 },
            "Top Dam (Barreira Gengival)": { cat: "DENTÍSTICA", marca: "ALLPLAN", min: 3 },
            "AGULHA DE IRRIGAÇÃO": { cat: "DIVERSOS", marca: "ALL PRIME", min: 1 },
            "LIQUIDO ACRILICO AUTOPOLIMERALIZAVEL TDV 500 ML": { cat: "DIVERSOS", marca: "TDV", min: 1 },
            "OLEO LUBRIFICANTE": { cat: "DIVERSOS", marca: "ALL PRIME", min: 1 },
            "ALGINATO ALVAGEL": { cat: "DIVERSOS", marca: "DENTSPLY", min: 6 },
            "ALGODAO ROLETE": { cat: "DIVERSOS", marca: "SSPLUS", min: 20 },
            "ANESTESICO SS WHITE LIDOSTESIN": { cat: "DIVERSOS", marca: "SS WHITE", min: 8 },
            "BABADOR": { cat: "DIVERSOS", marca: "ALL PRIME", min: 2 },
            "COLGADURAS": { cat: "DIVERSOS", marca: "GOLGRAN", min: 5 },
            "DESCARPACK 3L": { cat: "DIVERSOS", marca: "DESCARPACK", min: 2 },
            "DESCARPACK 7 L": { cat: "DIVERSOS", marca: "DESCARPACK", min: 1 },
            "GAZE HIDROFILICA": { cat: "DIVERSOS", marca: "ULTRACOTT", min: 3 },
            "GELINHOS": { cat: "DIVERSOS", marca: "-", min: 50 },
            "GESSO TIPO III AMARELO": { cat: "DIVERSOS", marca: "ASFER", min: 7 },
            "GESSO TIPO IV ROSA": { cat: "DIVERSOS", marca: "VIGODENT", min: 7 },
            "GRAU CIRURGICO 100X100": { cat: "DIVERSOS", marca: "ALLPRIME", min: 2 },
            "GRAU CIRURGICO 20X100": { cat: "DIVERSOS", marca: "ALLPRIME", min: 2 },
            "GRAU CIRURGICO 30X100": { cat: "DIVERSOS", marca: "ALLPRIME", min: 1 },
            "LUVAS COM PÓ P": { cat: "DIVERSOS", marca: "-", min: 40 },
            "MÁSCARA DESCARTÁVEL CAIXA COM 50": { cat: "DIVERSOS", marca: "SSPLUS", min: 5 },
            "MICRO BRUSH EXTRA FINO": { cat: "DIVERSOS", marca: "ALLPRIME", min: 3 },
            "RESINA ACRILICA POLIMERIZANTE JET PÓ ROSA 78G": { cat: "DIVERSOS", marca: "JET", min: 1 },
            "SERINGAS 10 ML": { cat: "DIVERSOS", marca: "DESCARPAK", min: 4 },
            "SERINGAS 20ML": { cat: "DIVERSOS", marca: "DESCARPAK", min: 4 },
            "SOFT REEMBASADOR": { cat: "DIVERSOS", marca: "TDV", min: 2 },
            "SUGADOR": { cat: "DIVERSOS", marca: "ALLPRIME", min: 25 },
            "TESTE BIOLOGICO - biological test": { cat: "DIVERSOS", marca: "2l", min: 2 },
            "TESTE QUIMICO- indicador quimico": { cat: "DIVERSOS", marca: "CLEAN UP", min: 4 },
            "TOUCA BRANCA": { cat: "DIVERSOS", marca: "DISCARPAK", min: 2 },
            "VASELINA SOLIDA": { cat: "DIVERSOS", marca: "RIOQUMICA", min: 1 },
            "CLOREXIDINA 0,12%": { cat: "ENDODONTIA", marca: "RIOQUIMICA", min: 5 },
            "CLOREXIDINA 2%": { cat: "ENDODONTIA", marca: "RIOQUIMICA", min: 1 },
            "CONE DE GUTAPERCHA 35.05(BASSI)": { cat: "ENDODONTIA", marca: "EASYBASSI", min: 1 },
            "CONE DE PAPEL 15-40": { cat: "ENDODONTIA", marca: "MKLIFE", min: 1 },
            "KIT ENDO IRRIGAÇÃO ENDO": { cat: "ENDODONTIA", marca: "ULTRADENT", min: 1 },
            "SERINGA IRRIGAÇÃO 5ML PACOTE COM 10": { cat: "ENDODONTIA", marca: "ULTRADENT", min: 1 },
            "HIDROXIDO DE CALCIO P.A": { cat: "ENDODONTIA", marca: "ULTRADENT", min: 1 },
            "CONE DE PAPEL 25": { cat: "ENDODONTIA", marca: "MKLIFE", min: 2 },
            "CONE DE PAPEL 45-80": { cat: "ENDODONTIA", marca: "MKLIFE", min: 2 },
            "CONE GUTAPERCHA 45- 80": { cat: "ENDODONTIA", marca: "BASSI", min: 1 },
            "CONE GUTAPERCHA F1": { cat: "ENDODONTIA", marca: "BASSI", min: 1 },
            "CONE GUTAPERCHA F2": { cat: "ENDODONTIA", marca: "BASSI", min: 1 },
            "CONE GUTAPERCHA F3 PROTAPER UNIVERSAL": { cat: "ENDODONTIA", marca: "PROTAPER", min: 1 },
            "EDTA": { cat: "ENDODONTIA", marca: "BIODINAMIC", min: 1 },
            "ENDOFIL PO": { cat: "ENDODONTIA", marca: "DENTSPLAY", min: 1 },
            "ENDOFIL LIQUIDO": { cat: "ENDODONTIA", marca: "DENTSPLAY", min: 1 },
            "EUCALIPTOL": { cat: "ENDODONTIA", marca: "BIODINAMIC", min: 1 },
            "FIO RETRATOR 00": { cat: "ENDODONTIA", marca: "BIODINAMIC", min: 2 },
            "FIO RETRATOR 000": { cat: "ENDODONTIA", marca: "BIODINAMIC", min: 2 },
            "FIXADOR": { cat: "ENDODONTIA", marca: "CARESTEA", min: 3 },
            "HIPOCLORITO DE SODIO 2,5%": { cat: "ENDODONTIA", marca: "ASFER", min: 1 },
            "HYDCAL": { cat: "ENDODONTIA", marca: "HYCAL", min: 3 },
            "LENCOL DE BORRACHA": { cat: "ENDODONTIA", marca: "MADEITEX", min: 2 },
            "LIMA ENDODONTICA 08 /25MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 10 /25MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 15 /25MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 15-40/25mm": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 15-40/31mm": { cat: "ENDODONTIA", marca: "ALPRIME", min: 1 },
            "LIMA ENDODONTICA 20 /25MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 25/25 MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "LIMA ENDODONTICA 45-80/25mm": { cat: "ENDODONTIA", marca: "ALPRIME", min: 1 },
            "LIMA ENDODONTICA 45-80/31mm": { cat: "ENDODONTIA", marca: "ALPRIME", min: 1 },
            "LIMA K ENDODONTICA 25 MM": { cat: "ENDODONTIA", marca: "ALL PRIME", min: 2 },
            "REVELADOR": { cat: "ENDODONTIA", marca: "CARESTEA", min: 3 },
            "TESTE DE VITALIDADE - ENDOICE": { cat: "ENDODONTIA", marca: "MAQUIRA", min: 1 },
            "TRICRESOL": { cat: "ENDODONTIA", marca: "BIODINAMICA", min: 1 },
            "LIMA ENDODONTICA 25 /25MM": { cat: "ENDODONTIA", marca: "ALPRIME", min: 2 },
            "ULTRACAL": { cat: "ENDODONTIA", marca: "ULTRADENT", min: 1 },
            "ADESIVO ORTHOCEM": { cat: "ORTODONTIA", marca: "FGM", min: 4 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 14 SUP c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 16 INF c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 16 SUP c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 16X22 INF c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 18 INF c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 18X25 INF c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL NITI TERMOATIVO 35º 20 INF c/ 10 un": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ARCO INTRAORAL AÇO INOXIDÁVEL 45/18 c/ 10": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "BOTÃO LINGUAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "BRAQUETE AUTO LIGADO": { cat: "ORTODONTIA", marca: "MORELLI", min: 4 },
            "BRAQUETE AUTO LIGADO ESTETICO": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "BRAQUETE CONVENCIONAL 100CASOS MORELLI SLOT 22": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "BRAQUETE ESTÉTICO": { cat: "ORTODONTIA", marca: "MORELLI", min: 3 },
            "BRAQUETE MORELLI SLP 11": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "BRAQUETE MORELLI SLP 12": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "BRAQUETE MORELLI SLP 21": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "BRAQUETE MORELLI SLP 22": { cat: "ORTODONTIA", marca: "MORELLI", min: 3 },
            "CAIXA PARA APARELHO C/10": { cat: "ORTODONTIA", marca: "SSPLUS", min: 2 },
            "CERA ORTODONTICA": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELASTICO BENGALINA BRANCO RENDA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA AMARELO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA AZUL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA AZUL BEBÊ": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA AZUL CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELASTICO BENGALINA AZUL MARINHO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA CINZA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA LARANJA CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA LILÁS": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA PEAR BLUES": { cat: "ORTODONTIA", marca: "MORELLI", min: 4 },
            "ELASTICO BENGALINA PINK CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA PRATEADO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA PRETO": { cat: "ORTODONTIA", marca: "MORELLI", min: 3 },
            "ELASTICO BENGALINA ROSA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA ROSA BEBÊ": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA ROSA PEROLA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA ROXO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA UVA CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERDE CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERDE LIMÃO CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERDE MAR": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERDE MUSGO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERDE PEROLA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERMELHO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VERMELHO CRISTAL": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINA VINHO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO BENGALINHA AZUL MARINHO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AMARELO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AMARELO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL BEBE CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL BEBE MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL MARINHO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL MARINHO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE AZUL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE BRANCO RENDA CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE BRANCO RENDA MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE CINZA CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE CINZA MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE LARANJA CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE LARANJA CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE LILAS CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELÁSTICO CORRENTE LILAS MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE MARFIM CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "ELÁSTICO CORRENTE MARFIM MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "ELÁSTICO CORRENTE PEARL BLUE CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PEARL BLUE MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PINK CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PINK CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PRATEADO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PRATEADO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE PRETO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELÁSTICO CORRENTE PRETO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELÁSTICO CORRENTE ROSA BEBE CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE ROSA BEBE MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE ROSA PEROLA CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE ROSA PEROLA MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE ROXO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE ROXO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE LIMAO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE LIMAO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE MAR CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE MAR MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE MUSGO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE MUSGO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE PEROLA CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERDE PEROLA MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERMELHO CRISTAL CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERMELHO CRISTAL MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERMELHO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VERMELHO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VINHO CURTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELÁSTICO CORRENTE VINHO MEDIO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO INTRAORAL MÉDIO 1/8": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ELASTICO INTRAORAL MEDIO 3/16": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO INTRAORAL PESADO 1/8": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ELASTICO INTRAORAL PESADO 3/16": { cat: "ORTODONTIA", marca: "MORELLI", min: 3 },
            "FIO AÇO 12 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 12 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 14 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 14 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16X16 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16X16 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16X22 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 16X22 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 17X25 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 17X25 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 18 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 18 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 18X25 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 18X25 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 19X25 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 19X25 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 20 INFERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO AÇO 20 SUPERIOR C/50 UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "FIO PRE-CONTORNADO 12 INF C/10 UND": { cat: "ORTODONTIA", marca: "ORTHOMETRIC", min: 2 },
            "FIO PRE-CONTORNADO 16 INF C/10 UND": { cat: "ORTODONTIA", marca: "ORTHOMETRIC", min: 2 },
            "FIO DE AMARILHO 0,25 MM": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO DE AMARILHO 0,30 MM": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO DE AMARILHO 0,35 MM": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "FIO DE AMARILHO 0,40 MM": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "FIO DE AMARILHO 0,45 MM": { cat: "ORTODONTIA", marca: "MORELLI", min: 0 },
            "FIO NITI 12 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 12 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 14 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 14 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 16 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 16 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 16X16 SUPERIOR 50UN": { cat: "ORTODONTIA", marca: "ORTHOMETRIC", min: 1 },
            "FIO NITI 16X16 INFERIOR 50UN": { cat: "ORTODONTIA", marca: "ORTHOMETRIC", min: 1 },
            "FIO NITI 16X22 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 16X22 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 17X25 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 17X25 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 18 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 18 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 18X25 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 19X25 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 18X25 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "ORTHOMETRIC", min: 1 },
            "FIO NITI 20 INFERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "FIO NITI 20 SUPERIOR 100UN": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "GANCHO PONTA BOLA RETO LONGO": { cat: "ORTODONTIA", marca: "MORELLI", min: 5 },
            "MINI ESPORÃO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "MOLA ABERTA": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "ORTOBITE AZUL": { cat: "ORTODONTIA", marca: "MORELLI", min: 2 },
            "ORTOBITE ROSA PINK": { cat: "ORTODONTIA", marca: "MAQUIRA", min: 2 },
            "SAQUINHO PARA ELASTICO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "STOP ABERTO": { cat: "ORTODONTIA", marca: "MORELLI", min: 1 },
            "TUBO MORELLI COLAGEM SIMPLES 16/17": { cat: "ORTODONTIA", marca: "MORELLI", min: 5 },
            "TUBO MORELLI COLAGEM SIMPLES 26/27": { cat: "ORTODONTIA", marca: "MORELLI", min: 5 },
            "TUBO MORELLI COLAGEM SIMPLES 36/37": { cat: "ORTODONTIA", marca: "MORELLI", min: 5 },
            "TUBO MORELLI COLAGEM SIMPLES 46/47": { cat: "ORTODONTIA", marca: "MORELLI", min: 5 }
        };

        // --- FUNÇÕES DE NAVEGAÇÃO ---
        window.showLoading = (show) => { document.getElementById('loading-overlay').style.display = show ? 'flex' : 'none'; }
        
        window.showAlert = (msg) => {
            const box = document.getElementById('alert-box');
            document.getElementById('alert-message').textContent = msg;
            box.style.display = 'block';
            setTimeout(() => box.style.display = 'none', 3000);
        }

        window.goToPage = (pageId) => {
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            const page = document.getElementById(pageId);
            if(page) page.style.display = pageId.includes('select-filial') || pageId.includes('login') ? 'flex' : 'block';
            window.scrollTo(0,0);
            if(window.lucide) lucide.createIcons();
            if(pageId === 'page-manage-stock') renderStockTable();
            if(pageId === 'page-order-form') renderOrderTable();
        }

        // --- FUNÇÕES FIREBASE (SUBSTITUINDO LOCALSTORAGE) ---
        
        // 1. Carregar Dados da Filial
        async function loadFilialData() {
            showLoading(true);
            try {
                // Tenta pegar o documento da filial
                const docRef = doc(db, "estoques", selectedFilial);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    // Se existe, carrega
                    filialInventory = docSnap.data().items;
                } else {
                    // Se não existe, cria com o catálogo padrão
                    filialInventory = {};
                    for (const [desc, item] of Object.entries(INITIAL_CATALOG)) {
                        filialInventory[desc] = {
                            descricao: desc,
                            categoria: item.cat,
                            marca: item.marca,
                            minimo: item.min,
                            estoque: 0
                        };
                    }
                    // Salva a primeira vez
                    await setDoc(doc(db, "estoques", selectedFilial), { items: filialInventory });
                }
            } catch (error) {
                console.error("Erro ao carregar:", error);
                showAlert("Erro de conexão. Verifique sua internet.");
            }
            showLoading(false);
        }

        // 2. Salvar Estoque
        window.saveStock = async () => {
            showLoading(true);
            try {
                await setDoc(doc(db, "estoques", selectedFilial), { items: filialInventory });
                showAlert("Estoque salvo na nuvem com sucesso!");
                goToPage('page-menu');
            } catch (error) {
                console.error("Erro ao salvar:", error);
                showAlert("Erro ao salvar. Tente novamente.");
            }
            showLoading(false);
        }

        // 3. Enviar Pedido
        window.submitOrder = async () => {
            if(Object.keys(currentOrder).length === 0 && !currentExtraItems) return showAlert("Pedido vazio!");

            showLoading(true);
            const order = {
                filial: selectedFilial,
                createdAt: new Date().toISOString(),
                items: currentOrder,
                extraItems: currentExtraItems,
                status: 'Pendente',
                timestamp: Date.now() // Útil para ordenação
            };
            
            try {
                // Adiciona na coleção "pedidos"
                await addDoc(collection(db, "pedidos"), order);
                showAlert("Pedido enviado para o Admin!");
                goToPage('page-menu');
            } catch (error) {
                console.error("Erro ao enviar pedido:", error);
                showAlert("Erro ao enviar. Verifique conexão.");
            }
            showLoading(false);
        }

        // 4. Carregar Painel Admin (Lê todos os pedidos)
        window.loadAdminPanel = async () => {
            showLoading(true);
            const container = document.getElementById('admin-list-container');
            container.innerHTML = '';
            let hasOrders = false;

            try {
                // Busca pedidos pendentes
                const q = query(collection(db, "pedidos"), where("status", "==", "Pendente"), orderBy("timestamp", "desc"));
                const querySnapshot = await getDocs(q);

                querySnapshot.forEach((doc) => {
                    hasOrders = true;
                    const order = doc.data();
                    const orderId = doc.id; // ID do documento no Firebase

                    const div = document.createElement('div');
                    div.className = "bg-white p-6 rounded shadow border-l-4 border-yellow-400";
                    div.innerHTML = `
                        <div class="flex justify-between font-bold text-lg mb-4 pb-2 border-b">
                            <span class="text-blue-800">${order.filial}</span>
                            <span class="text-gray-500 text-base">${new Date(order.createdAt).toLocaleDateString()}</span>
                        </div>
                        <div class="mb-4 text-gray-700">
                            <ul class="list-disc ml-5 space-y-1">
                                ${Object.entries(order.items).map(([k,v]) => `<li><span class="font-bold">${v}x</span> ${k}</li>`).join('')}
                            </ul>
                            ${order.extraItems ? `<div class="mt-4 p-3 bg-gray-50 rounded text-sm italic text-gray-600 border border-gray-200"><strong>Obs:</strong> ${order.extraItems}</div>` : ''}
                        </div>
                        <div class="flex gap-4 pt-2">
                            <button onclick="updateStatus('${orderId}', 'Aprovado')" class="flex-1 bg-green-100 text-green-700 px-4 py-3 rounded font-bold hover:bg-green-200 transition-colors">Aprovar Pedido</button>
                            <button onclick="updateStatus('${orderId}', 'Rejeitado')" class="flex-1 bg-red-100 text-red-700 px-4 py-3 rounded font-bold hover:bg-red-200 transition-colors">Rejeitar</button>
                        </div>
                    `;
                    container.appendChild(div);
                });

            } catch (error) {
                console.error("Erro admin:", error);
                showAlert("Erro ao carregar pedidos.");
            }

            document.getElementById('no-pending-orders').style.display = hasOrders ? 'none' : 'block';
            showLoading(false);
        }

        // 5. Atualizar Status do Pedido
        window.updateStatus = async (orderId, newStatus) => {
            showLoading(true);
            try {
                const orderRef = doc(db, "pedidos", orderId);
                await updateDoc(orderRef, {
                    status: newStatus
                });
                showAlert(`Pedido ${newStatus}!`);
                loadAdminPanel(); // Recarrega a lista
            } catch (error) {
                console.error("Erro update:", error);
                showAlert("Erro ao atualizar status.");
            }
            showLoading(false);
        }
        
        window.refreshAdminPanel = () => { loadAdminPanel(); }

        // --- TABELAS E UI (Idêntico ao anterior) ---
        function groupProducts(list) {
            const grouped = {};
            list.forEach(p => {
                if(!grouped[p.categoria]) grouped[p.categoria] = [];
                grouped[p.categoria].push(p);
            });
            return grouped;
        }

        function renderStockTable() {
            const tbody = document.getElementById('stock-table-body');
            tbody.innerHTML = '';
            const list = Object.values(filialInventory).sort((a,b) => a.descricao.localeCompare(b.descricao));
            const grouped = groupProducts(list);

            for (const [cat, prods] of Object.entries(grouped).sort()) {
                tbody.innerHTML += `<tr class="bg-gray-200"><td colspan="4" class="px-6 py-2 font-bold text-sm uppercase text-gray-700">${cat}</td></tr>`;
                prods.forEach(p => {
                    tbody.innerHTML += `
                        <tr class="border-b hover:bg-gray-50">
                            <td class="px-6 py-3">
                                <div class="font-medium text-gray-800">${p.descricao}</div>
                                <div class="text-xs text-gray-500">${p.marca}</div>
                            </td>
                            <td class="text-center"><input type="number" class="w-20 border rounded p-1 text-center" value="${p.minimo}" onchange="updateLocalProduct('${p.descricao}', 'minimo', this.value)"></td>
                            <td class="text-center"><input type="number" class="w-20 border rounded p-1 text-center font-bold text-blue-600" value="${p.estoque}" onchange="updateLocalProduct('${p.descricao}', 'estoque', this.value)"></td>
                            <td class="text-center"><button class="text-red-500 hover:text-red-700 p-2" onclick="removeProduct('${p.descricao}')"><i data-lucide="trash-2" class="w-5 h-5"></i></button></td>
                        </tr>
                    `;
                });
            }
            lucide.createIcons();
        }

        window.updateLocalProduct = (desc, field, val) => {
            if(filialInventory[desc]) filialInventory[desc][field] = parseInt(val) || 0;
        }

        window.removeProduct = (desc) => {
            if(confirm("Remover este produto da lista?")) {
                delete filialInventory[desc];
                renderStockTable(); // Apenas atualiza visualmente, só salva no banco ao clicar em Salvar
            }
        }

        function renderOrderTable() {
            const tbody = document.getElementById('order-table-body');
            tbody.innerHTML = '';
            const list = Object.values(filialInventory).sort((a,b) => a.descricao.localeCompare(b.descricao));
            const grouped = groupProducts(list);

            for (const [cat, prods] of Object.entries(grouped).sort()) {
                tbody.innerHTML += `<tr class="bg-gray-200"><td colspan="5" class="px-6 py-2 font-bold text-sm uppercase text-gray-700">${cat}</td></tr>`;
                prods.forEach(p => {
                    const sug = Math.max(0, p.minimo - p.estoque);
                    tbody.innerHTML += `
                        <tr class="border-b hover:bg-gray-50">
                            <td class="px-6 py-3">
                                <div class="font-medium text-gray-800">${p.descricao}</div>
                                <div class="text-xs text-gray-500">${p.marca}</div>
                            </td>
                            <td class="text-center text-gray-500">${p.minimo}</td>
                            <td class="text-center text-gray-500">${p.estoque}</td>
                            <td class="text-center font-bold ${sug>0?'text-red-600':''}">${sug}</td>
                            <td class="text-center"><input type="number" class="w-20 border rounded p-1 text-center order-qtd ${sug>0?'bg-green-50 border-green-300':''}" data-desc="${p.descricao}" value="${sug}"></td>
                        </tr>
                    `;
                });
            }
        }

        window.reviewOrder = () => {
            currentOrder = {};
            document.querySelectorAll('.order-qtd').forEach(el => {
                const qtd = parseInt(el.value);
                if(qtd > 0) currentOrder[el.dataset.desc] = qtd;
            });
            currentExtraItems = document.getElementById('extra-items-textarea').value;
            
            const div = document.getElementById('review-summary-container');
            div.innerHTML = `<h3 class="font-bold text-lg mb-4 border-b pb-2">Itens Selecionados</h3>`;
            if(Object.keys(currentOrder).length === 0) div.innerHTML += '<p class="text-gray-500 italic">Nenhum item selecionado.</p>';
            else {
                const ul = document.createElement('ul');
                ul.className = "space-y-2";
                for(const [k,v] of Object.entries(currentOrder)) {
                    ul.innerHTML += `<li class="flex justify-between border-b border-gray-100 pb-1"><span>${k}</span><span class="font-bold bg-blue-100 text-blue-800 px-2 py-0.5 rounded">${v}</span></li>`;
                }
                div.appendChild(ul);
            }
            if(currentExtraItems) div.innerHTML += `<h3 class="font-bold text-lg mt-6 mb-2 border-b pb-2">Observações</h3><p class="p-3 bg-yellow-50 rounded text-gray-700">${currentExtraItems}</p>`;
            
            goToPage('page-review-order');
        }

        window.filterTable = (input, tbody) => {
            const term = document.getElementById(input).value.toLowerCase();
            const rows = document.getElementById(tbody).querySelectorAll('tr');
            rows.forEach(r => {
                if(!r.cells[0]) return; 
                const txt = r.innerText.toLowerCase();
                r.style.display = txt.includes(term) ? '' : 'none';
            });
        }
        
        // --- LOGINS ---
        window.goToLogin = (f) => { selectedFilial = f; document.getElementById('login-filial-name').innerText = f; goToPage('page-login'); }
        window.handleFilialLogin = () => { 
            if(document.getElementById('filial-password').value === FILIAL_PASSWORDS[selectedFilial]) { 
                loadFilialData(); // Carrega do Firebase
                document.getElementById('menu-filial-name').innerText = selectedFilial; 
                document.getElementById('stock-filial-name').innerText = selectedFilial; 
                goToPage('page-menu'); 
            } else { 
                showAlert("Senha incorreta!"); 
            } 
        }
        window.goToAdminLogin = () => goToPage('page-admin-login');
        window.handleAdminLogin = () => { 
            if(document.getElementById('admin-password').value === ADMIN_PASSWORD) { 
                loadAdminPanel(); // Carrega do Firebase
                goToPage('page-admin-panel'); 
            } else { 
                showAlert("Senha incorreta!"); 
            } 
        }
        window.logout = () => goToPage('page-select-filial');
        
        window.printOrder = (items, extras) => {
            const area = document.getElementById('print-area');
            let html = `<div class="print-header">Pedido - ${selectedFilial || ''}</div><table class="print-table"><thead><tr><th>Item</th><th>Qtd</th></tr></thead><tbody>`;
            for(const [k,v] of Object.entries(items)) html += `<tr><td>${k}</td><td>${v}</td></tr>`;
            html += `</tbody></table>`;
            if(extras) html += `<div style="margin-top:20px; border:1px solid #eee; padding:10px;"><b>Observações:</b><br>${extras}</div>`;
            area.innerHTML = html;
            window.print();
        }

        // --- ADICIONAR PRODUTO ---
        window.openAddProductModal = () => { document.getElementById('modal-add-product').style.display = 'flex'; }
        window.closeAddProductModal = () => { document.getElementById('modal-add-product').style.display = 'none'; }
        window.addNewProduct = () => {
            const desc = document.getElementById('new-prod-desc').value;
            if(!desc) return;
            filialInventory[desc] = {
                descricao: desc,
                categoria: document.getElementById('new-prod-cat').value || 'DIVERSOS',
                marca: document.getElementById('new-prod-marca').value || '',
                minimo: 0,
                estoque: 0
            };
            // Salva diretamente no Firebase para persistir a mudança de catálogo
            saveStock();
            closeAddProductModal();
            renderStockTable();
        }

        // Inicializa
        goToPage('page-select-filial');

    </script>
</body>
</html>